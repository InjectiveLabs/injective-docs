---
title: 设置 Keyring
---

<Callout icon="info" color="#07C1FF" iconType="regular">
本文档描述了如何为 Injective 节点配置和使用 keyring 及其各种后端。在设置 keyring 之前应先安装 `injectived`。有关更多信息，请参阅[安装 `injectived` 页面](../developers/injectived/install/)。
</Callout>

Keyring 保存用于与节点交互的私钥/公钥对。例如，在运行 Injective 节点之前需要设置验证者密钥，以便正确签署区块。私钥可以存储在不同的位置，称为"后端"，例如文件或操作系统自己的密钥存储。

### Keyring 的可用后端

#### `os` 后端

`os` 后端依赖于操作系统特定的默认值来安全地处理密钥存储。通常，操作系统的凭据子系统根据用户的密码策略处理密码提示、私钥存储和用户会话。以下是最流行的操作系统及其各自的密码管理器列表：

* macOS（自 Mac OS 8.6 起）：[Keychain](https://support.apple.com/en-gb/guide/keychain-access/welcome/mac)
* Windows：[Credentials Management API](https://docs.microsoft.com/en-us/windows/win32/secauthn/credentials-management)
* GNU/Linux：
  * [libsecret](https://gitlab.gnome.org/GNOME/libsecret)
  * [kwallet](https://api.kde.org/frameworks/kwallet/html/index.html)

使用 GNOME 作为默认桌面环境的 GNU/Linux 发行版通常附带 [Seahorse](https://wiki.gnome.org/Apps/Seahorse)。基于 KDE 的发行版的用户通常会获得 [KDE Wallet Manager](https://userbase.kde.org/KDE_Wallet_Manager)。前者实际上是一个 `libsecret` 便捷前端，后者是一个 `kwallet` 客户端。

`os` 是默认选项，因为操作系统的默认凭据管理器旨在满足用户最常见的需求，并在不影响安全性的情况下为他们提供舒适的体验。

无头环境推荐的后端是 `file` 和 `pass`。

#### `file` 后端

`file` 将 keyring 加密存储在应用程序的配置目录中。每次访问此 keyring 时都会请求密码，这可能在单个命令中多次发生，导致重复的密码提示。如果使用 bash 脚本执行使用 `file` 选项的命令，你可能需要使用以下格式处理多个提示：

```bash
# 假设 KEYPASSWD 在环境中设置
yes $KEYPASSWD | injectived keys add me
yes $KEYPASSWD | injectived keys show me
# 使用 keyring-backend 标志启动 injectived
injectived --keyring-backend=file start
```

<Callout icon="info" color="#07C1FF" iconType="regular">
第一次向空 keyring 添加密钥时，系统会提示你输入两次密码。
</Callout>

#### `pass` 后端

`pass` 后端使用 [pass](https://www.passwordstore.org/) 实用程序来管理密钥敏感数据和元数据的磁盘加密。密钥存储在应用程序特定目录中的 `gpg` 加密文件中。`pass` 可用于大多数流行的 UNIX 操作系统以及 GNU/Linux 发行版。有关如何下载和安装的信息，请参阅其手册页。

<Callout icon="info" color="#07C1FF" iconType="regular">
`pass` 使用 [GnuPG](https://gnupg.org/) 进行加密。`gpg` 在执行时自动调用 `gpg-agent` 守护进程，该守护进程处理 GnuPG 凭据的缓存。有关如何配置缓存参数（如凭据 TTL 和密码过期）的更多信息，请参阅 `gpg-agent` 手册页。
</Callout>

在首次使用之前必须设置密码存储：

```sh
pass init <GPG_KEY_ID>
```

将 `<GPG_KEY_ID>` 替换为你的 GPG 密钥 ID。你可以使用个人 GPG 密钥或你可能想专门用于加密密码存储的替代密钥。

#### `kwallet` 后端

`kwallet` 后端使用 `KDE Wallet Manager`，它默认安装在以 KDE 作为默认桌面环境的 GNU/Linux 发行版上。有关更多信息，请参阅 [KWallet 手册](https://docs.kde.org/stable/en/kdeutils/kwallet/index.html)。

#### `test` 后端

`test` 后端是 `file` 后端的无密码变体。密钥以未加密的形式存储在磁盘上。

**仅供测试目的。不建议在生产环境中使用 `test` 后端**。

#### `memory` 后端

`memory` 后端将密钥存储在内存中。程序退出后密钥会立即删除。

**仅供测试目的。不建议在生产环境中使用 `memory` 后端**。

### 向 keyring 添加密钥

你可以使用 `injectived keys` 获取有关 keys 命令的帮助，使用 `injectived keys [command] --help` 获取有关特定子命令的更多信息。

<Callout icon="info" color="#07C1FF" iconType="regular">
你还可以使用 `injectived completion` 命令启用自动完成。例如，在 bash 会话开始时，运行 `. <(injectived completion)`，所有 `injectived` 子命令都将自动完成。
</Callout>

要在 keyring 中创建新密钥，请使用 `<key_name>` 参数运行 `add` 子命令。在本教程中，我们将仅使用 `test` 后端，并将新密钥命名为 `my_validator`。此密钥将在下一节中使用。

```bash
$ injectived keys add my_validator --keyring-backend test

# 将生成的地址放入变量中以供以后使用。
MY_VALIDATOR_ADDRESS=$(injectived keys show my_validator -a --keyring-backend test)
```

此命令生成一个新的 24 字助记词短语，将其持久化到相关后端，并输出有关密钥对的信息。如果此密钥对将用于持有有价值的代币，请务必将助记词短语写在安全的地方！

默认情况下，keyring 生成 `eth_secp256k1` 密钥对。keyring 还支持 `ed25519` 密钥，可以通过传递 `--algo ed25519` 标志来创建。当然，keyring 可以同时持有两种类型的密钥。
